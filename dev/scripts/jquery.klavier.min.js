/*! jquery.klavier - v1.1.0 - 2014-03-23
* https://github.com/learningmedia/jquery.klavier
* Copyright (c) 2014 Andreas Helmberger & Ulrich Kaiser; Licensed MIT */
(function(e,t){if("object"==typeof exports){var i=require("jquery");t(i)}else"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(this,function(e){var t=0,i=120,s=.6,n=.6,r="klavier",a=[1,3,6,8,10],o=function(e,t){e.css("position","relative").addClass(t.cssPrefix+"-container").on("click."+r,"."+t.cssPrefix+"-key",d)},l=function(t,i){var r,a,o=u.getWhiteKeyCount(i.startKey,i.endKey),l=t.innerWidth()/o,c=s*l,d=t.innerHeight(),f=n*d,h=0;for(a=i.startKey;i.endKey>=a;a++)r=u.isBlackKey(a),e("<div></div>").css({position:"absolute",width:(r?c:l)+"px",height:(r?f:d)+"px",top:"0px",left:(r?h-c/2:h)+"px",zIndex:r?i.zIndex+1:i.zIndex}).addClass(i.cssPrefix+"-key").addClass(i.cssPrefix+(r?"-black-key":"-white-key")).attr("data-value",a).appendTo(t),r||(h+=l)},c=function(t){return parseInt(e(t).data("value"),10)},d=function(e){var t=u.getOrCreate(e.delegateTarget),i=c(e.target),s=t.getSelectedValues(),n=s.indexOf(i);switch(t.options.selectionMode){case"single":s=-1===n?[i]:[];break;case"multiple":-1===n?s.push(i):s.splice(n,1);break;default:s=[]}t.setSelectedValues(s)},u=function(t,i){this.options=e.extend({},u.defaults,i),this.$el=e(t),this.$el.data(r,this),o(this.$el,this.options),l(this.$el,this.options)};u.prototype.destroy=function(){this.$el.removeData(r),this.$el.removeClass(this.options.cssPrefix+"-container"),this.$el.off("."+r),this.$el.empty(),this.$el=null},u.prototype.getSelectedValues=function(){return this.$el.find("."+this.options.cssPrefix+"-selected-key").get().map(function(e){return c(e)})},u.prototype.setSelectedValues=function(t){this.$el.find("."+this.options.cssPrefix+"-key").each(function(i,s){var n=-1!==t.indexOf(c(s));e(s).toggleClass(this.options.cssPrefix+"-selected-key",n)}.bind(this)),"function"==typeof this.options.onSelectedValuesChanged&&this.options.onSelectedValuesChanged(this.getSelectedValues())},u.getOrCreate=function(t,i){return e(t).data(r)||new u(t,i)},u.isBlackKey=function(e){var t=e%12;return-1!==a.indexOf(t)},u.getWhiteKeyCount=function(e,t){var i,s=0;for(i=e;t>=i;i++)u.isBlackKey(i)||(s+=1);return s},u.validateOptions=function(e){if(e.endKey<=e.startKey)throw Error("The end key must be greater than the start key.");if(t>e.startKey||e.endKey>i)throw Error("The key values must be grater than or equal to "+t+" and less than or euqal to "+i+".");if(u.isBlackKey(e.startKey))throw Error("The keyboard has to start with a white key.");if(u.isBlackKey(e.endKey))throw Error("The keyboard has to end with a white key.")},u.defaults={startKey:60,endKey:71,selectionMode:"multiple",cssPrefix:"klavier",zIndex:999},e.fn.klavier=function(e){var t=Array.prototype.slice.call(arguments,1);if("string"==typeof e){var i=this.get().map(function(i){var s=u.getOrCreate(i),n=s[e].apply(s,t);return n});return i.length?i[0]:void 0}return this.each(function(){u.getOrCreate(this,e)})},e.fn.klavier.defaults=u.defaults,e.fn.klavier._constructor=u});